{"componentChunkName":"component---node-modules-pitayan-gatsby-theme-pitayan-src-templates-post-index-tsx","path":"/webbrowser-phishing-lnk-file/","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Webbrowser based phishing technique\",\n  \"author\": [\"Adrian Kydland Skaftun\"],\n  \"date\": \"2022-10-01T00:00:00.000Z\",\n  \"categories\": [\"KQL\", \"Azure Sentinel\", \"Kusto\"],\n  \"description\": \"A high overview of the recently discovered phishing technique, and how to hunt for it.\",\n  \"hero\": \"media/dall-e-hacker.png\",\n  \"slug\": \"webbrowser-phishing-lnk-file\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"webbrowser-based-phishing-technique\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h1\",\n    \"href\": \"#webbrowser-based-phishing-technique\",\n    \"aria-label\": \"webbrowser based phishing technique permalink\",\n    \"className\": \"heading-anchor before\"\n  }, mdx(\"span\", {\n    parentName: \"a\"\n  }, \"#\")), \"Webbrowser based phishing technique\"), mdx(\"p\", null, \"Phishing is one of the most dangerous and ugliest types of attacks out there, because it is based on human interaction, naiveness and error. The only reason for a computer to fail is because someone told it to - meaning errors in code or other related human misconfigurations. MFA fatigue is one ongoing way of exploiting human \\u201Cweakness\\u201D as Kjetil mentioned in his blogpost relating to the Uber breach. I\\u2019m going to highlight another,  new technique demonstrated by \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://mrd0x.com/phishing-with-chromium-application-mode/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }, \"mr.d0x\"), \". And we will dive into some KQL to help you investigate this kind of attack further by hunting for the obvious relating to it.\"), mdx(\"h2\", {\n    \"id\": \"phishing-technique-walkthrough\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#phishing-technique-walkthrough\",\n    \"aria-label\": \"phishing technique walkthrough permalink\",\n    \"className\": \"heading-anchor before\"\n  }, mdx(\"span\", {\n    parentName: \"a\"\n  }, \"#\")), \"Phishing technique walkthrough\"), mdx(\"p\", null, \"This technique uses Chromium based browsers like Google Chrome or MSEdge as a Desktop applications with local malicious login forms disguised as a trustworthy app. It all takes the form of a shortcut file, lnk, with a tiny script.\"), mdx(\"p\", null, \"What makes this phishing technique stealthy is that it hides it self in appearance of a regular Desktop app. Once you open the app it launches a webbrowser in app-mode, which does not have the addressbar at the top - meaning that you have one less way of approving that the site you are directed to is legitimate. You can easily design a fake address bar as well as the logo for the application, hiding everything obvious that resembles an lnk file, just like mr.d0x did in the article above.\"), mdx(\"h3\", {\n    \"id\": \"what-is-an-lnk-file\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#what-is-an-lnk-file\",\n    \"aria-label\": \"what is an lnk file permalink\",\n    \"className\": \"heading-anchor before\"\n  }, mdx(\"span\", {\n    parentName: \"a\"\n  }, \"#\")), \"What is an lnk file?\"), mdx(\"p\", null, \"The name kinda gives it away - it links to another file. Normally refered to as a shortcut. The actual file is stored somewhere else, and a shortcut file only points to where the data is stored. What is also worth mentioning about these files is that their extension is not showing, even if you have enabled windows to show extensions.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"239px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"22.594142259414227%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAqElEQVQY043NuwrCMBhA4TyHvaTaxDRK8yc2nRSR2qFCk/Tmcwji67g6OzkLvpiDq4V+++Gg8liQOA6DIAhC3/c9bxZNhu7P926377uhbZw1zpg6XkRhiCfFl+sNQOZ5rrVWapNrnSTJinNCCaWUELIchx6vz/Z3bhtT21NVSSn74dw566yrrRNrjjGe/4MORck5BwFKKRCgs4wxlqapBBACpJQJY2PnL9abNqWN4igoAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"20221014152629\",\n    \"title\": \"20221014152629\",\n    \"src\": \"/static/4934eb8319fdb2c4a2f06adee89dd4d6/9a782/20221014152629.png\",\n    \"srcSet\": [\"/static/4934eb8319fdb2c4a2f06adee89dd4d6/9a782/20221014152629.png 239w\"],\n    \"sizes\": \"(max-width: 239px) 100vw, 239px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"  \"), mdx(\"p\", null, \"This also lets us masquerade the file as whatever we want. The shortcut symbol may give it away, but this may be replaced by another symbol if you have it in a OneDrive synced folder for instance. \"), mdx(\"p\", null, \"The appmode mentioned belongs to Chromium browsers, which is an open source project that a lot of todays modern browsers are based upon. \"), mdx(\"p\", null, \"Lets create the payload as shown in the screenshot:\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"355px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"151.26760563380282%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAIAAACjcKk8AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADY0lEQVQ4y91V23KrNhTl/3+o02mmDifgS1zj2MkBGwcQEuAYgSTEVVxMB+N4cjpJptPHrifdlqS9tPaWBEPueCfXdlwHOJbjWLYL3Lpp+29xPp8xxhLnWZqmhBDGGOecDo0ky/OyLKuqKsuyeEdZXnuXRpllmUQJiePYMIynp20QBCxJGGMY48Vs/vz8k1JKCKGUGoa+fnra73aapm22z2GICYklQkia8p1hLOYL2waMsaIo+r73Pd/QjTDEfd9XVUUpdRywWq3m89njUqOMUUqksixE06d5XZZlXdfnC26Bje3z+dy2bdM0lziGcNq2FUJI56b+7XF/t33r+77IC8cBwHVv/G/QNI0khHh1/ZCQvu/rus6yrCyL21FfYZyVqqrKs2yUrWmasixxFOEI5/mwRfc1riefTicXQt8PmrbNUg4A8D2Pp9kY7ce3/SBI39T1QMYhhtD1PM9xnJgQ1wYuAIwl/yrmCEe+H7TduW9qNns8yj/YYs6Xy1BRIlXNVqt4NmWPj6eHh+MPOZqqfLVkDw+5YQ7kOIqD43G4Ti3efp/s5OlxoXmz5WGiWJMHf/4XVBdQWRz+VHZ395asovnS/eOeLdeDYF3XtW0nhGjatohj5qIE+Qx63Au4FzDoJchjyOOen/pH7l9HRJ5JQlQIQuQHXdf1fZ+kGQqOB8u2ANgdDrpp6uZB35vG4RUgZNrO3no92M6r4/A0HU5O0zTlPM/zrus4574fUEqTZHB58gGc88vYdTDPc0lUFcYYQei6kLFhhWXbZVXdXPkpmqYZyFVVkpiIuh4fgBKq6/p+b+q6bppm8AUQQiO5IjEV4komcbxer5+3L9vt9uWn/hXZ87wrOcLYssEt+0blRivdzDje9mbY67WFEEVRRFFECEmShJD4dAqH9Kf07e0UxxGOBlymSBiGl96wuCgKqa5rjLGiqLPpVFWn89lsMplYlhMEvqqosiwrqqpp6zAMAQCyLMv38ny+cF04lCEhxKf17bOU+KVIXL3d/yf8r8g3WT4K+A85r+Tq3ca/4H2Xb4po27bSmC4jkuHv4eCNPgOs7dHWOb24URhihBCEMAiCMAwhhM5Qn4HruhL7AMpYypMtCFd7eKdqixdLNXyI/CdNUxR1vzcRQpvNZjqdLpfLzWbzNxYHmn+vxVI4AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"20221014154415\",\n    \"title\": \"20221014154415\",\n    \"src\": \"/static/4d5633bc5d8f075a20408c5226124746/ed409/20221014154415.png\",\n    \"srcSet\": [\"/static/4d5633bc5d8f075a20408c5226124746/ed409/20221014154415.png 355w\"],\n    \"sizes\": \"(max-width: 355px) 100vw, 355px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"  \"), mdx(\"p\", null, \"Paste this snippet into the \\u201CTarget\\u201D field within the shortcut files properties if you are changing a shorcut already made. If you are creating a new one, paste it into the window that appears through the wizard.\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"\\\"C:\\\\Program Files (x86)\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe\\\" --app=https://www.amestofortytwo.com/\"))), mdx(\"p\", null, \"Here is what the output looks like once you open the file:\\n\", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"767px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"84.35462842242502%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADYklEQVQ4y2WT/U9TdxTGv5T23ra09PvW3tJ7b3vvpU3YaicUhOAKky6SWGNkooACAtXy4lCwrh2j44dN3NgIxuGGU6SCINB0xaJVfINEReeS+R/sj1kuMVHk5MlJzg+fnJM8zwETN+e/+XGsqrqmJ3G949yYUlwsiKLi8chut+Jxe30+r8/3idfr9X3m9ngcAi84nYLT6RCFMr8fjMw/H0m+bG5rG8/9m978T/a4d1dXN7a2Hm5pqQrWaRHUIajDiMGIJZjFmEEQC4KJs/X094N4fCh2Ibb/wKGjrR0NR44IkqT4dpUHAsFQyB8IMBgZCNETzBJsILjASg2EcIpiU5QzAwOA4zi7nZMkl7tYKZYljueBqQAYjcBkAoVmLUYMwQzBOoy0GBVQauV5u9MFAIh+NwSUrZIkyeWSZFm2CwJDqd5K9VYrSylDCEOIOlLKElJgs0I7R3keMGwskQDSB6XCDoeu0KQtNDPQYsDISImRYj1GRvVspEdQV2hmkUXd/G0cfEiKolha5m863t5wtPnwseMtJ7vaw92dp3tPtHd2nYp0hiPhSG/zifavGo+FDh6amUm+hxVFKSoqCh0IZVLZ1GJmaTGztJBeXly5M7ecmk+vpLJ3U9m/FjNLs3dScwvLM7f+ebm5bbPD4dgf/PL2jeTaau7pwye5lXvPcmsjieGR4cSrjRdPc2sPMtlH2dVn9++lb954vbG+Ew7OXP19dupa8uof2eXUm42NaPT84OC5vx+vbT56uH43fT/554Pb09nrV96++Ajm+X21tROjP4//cGni4ujk2C8LU1ORcLguWDf32+W5ycuzV8anfx2dHrs4ORxdX13ZBguCUFFR1d3d3x05e6ZvsK9ncOBsvLGhqX5fMHE+Hvt6INrb39d5uq+to6m+PnltaptVkiQ5ZdlZUuL1V5RXB/bsrancW1NWvqfS76+rqf3i80BlRaXXu6u0tFQQhdGfLu3wWeANFDNEDbMWWYjooC7eyFlNdhu7lTMDxSbOBrT5scTwx3CRwOswyoNQgxEwm8USt+tTj0XkqSTqbVSDoBZBllKQBy4MDW2DFVnmeD4PWjTQokFQA2E+QhoINdCSD2E+hBqkdj2lAIDY9zvjyfMsVh9oS0SVmlBV70aCzTYrYJiuSOR/ywv1kSChel8AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"20221014154259\",\n    \"title\": \"20221014154259\",\n    \"src\": \"/static/7ea9c1ef38d6fa04feb0712c7098b05e/dff2b/20221014154259.png\",\n    \"srcSet\": [\"/static/7ea9c1ef38d6fa04feb0712c7098b05e/dff2b/20221014154259.png 767w\"],\n    \"sizes\": \"(max-width: 767px) 100vw, 767px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Note the minimalistic web browser view, no address bar, jpg icon, pdf extension. Also - another thing that makes it harder to spot is that Windows Taskbar displays the favicon of the webpage, not the browser icon.\"), mdx(\"p\", null, \"Note! This is not a well thought-through attack I\\u2019m showing (with jpg icon and pdf extension), it just shows some possibilities.\"), mdx(\"h3\", {\n    \"id\": \"kql-query-to-go-hunt-for-this-activity\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#kql-query-to-go-hunt-for-this-activity\",\n    \"aria-label\": \"kql query to go hunt for this activity permalink\",\n    \"className\": \"heading-anchor before\"\n  }, mdx(\"span\", {\n    parentName: \"a\"\n  }, \"#\")), \"KQL-query to go hunt for this activity\"), mdx(\"p\", null, \"Armed with some knowledge on how this exploit works, it\\u2019s time to go hunt for it. We know that it runs a command when opened - well, lets look for it. We also know what the command might contain (like browsers), and that it uses appmode (\\u201C\\u2014app\\u201D), it might reach out to the wide web (\\u201Chttp\\u201D). Lets limit this to use with only lnk files as well. Use this query as a starting place to dig deeper into your logs. \"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"DeviceFileEvents\\n| where InitiatingProcessFileName has_any (\\\"msedge\\\", \\\"chrome\\\")\\n| where InitiatingProcessCommandLine has_any (\\\"--app\\\", \\\"http\\\")\\n| where FileName endswith \\\"lnk\\\"\\n| project\\n    TimeGenerated,\\n    DeviceName,\\n    FileName,\\n    FolderPath,\\n    InitiatingProcessFolderPath,\\n    InitiatingProcessAccountName,\\n    InitiatingProcessCommandLine,\\n    PreviousFileName,\\n    MD5,\\n    SHA1,\\n    SHA256\\n    \"))), mdx(\"p\", null, \"The above query does not give you any answers, it just looks at indicators known to belong to this attack. It\\u2019s up to you to investigate the maliciousness of the query output. Correlating between known indicators (file-hashes, IPs\\u2026), tactics and behavior will take you far.\"), mdx(\"p\", null, \"A wider search option would be to search for related artefacts of this attack by this query (feel free to change what\\u2019s inside the quotes or even the tables). This query searches through all tables that starts with \\u201CDevice\\u201D where \\u201C\\u2014app\\u201D is present:\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"search in (Device*) \\\"--app\\\"\"))), mdx(\"p\", null, \"You can do a search for files in the aggregated table \\u201CimFileEvent\\u201D and see if there is a mismatch between the extension of the filename and the actual filetype. Doing this I also learned that the actual file type is appended to the filename by Sentinel, which means that there will be two file extensions when viewing the logs, if the mentioned technique is being applied. Try finding this by:\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"let knownFileExts = dynamic([\\\"pdf\\\", \\\"jpg\\\", \\\"txt\\\", \\\"bin\\\", \\\"exe\\\"]);\\nimFileEvent\\n| where SourceFileExtension == \\\"lnk\\\"\\n| extend splittedFNExt = split(SourceFileName, \\\".\\\")\\n| where splittedFNExt[-2] in (knownFileExts)\"))), mdx(\"p\", null, \"We are creating a dynamic variable type which we populate with a list of known fileextensions(nowhere complete). And then we limit the result from imFileEvent on the fileextension \\u201Clnk\\u201D (which we know is added inside the logs) before we split the filename, to compare the possible double fileextension based on the list of fileextensions.\"), mdx(\"p\", null, \"Here is a wider, yet powerfull search. Tune it to your need. This looks through every table that starts with \\u201CDevice\\u201D and where any rows has \\u201C\\u2014app\\u201D. Before we shorten it down even more with \\u201Clnk\\u201D in FileName.\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"search in (Device*) \\\"--app\\\"\\n| where FileName has \\\"lnk\\\"\"))), mdx(\"p\", null, \"Another approach will be to first look for lnk files that have been downloaded, maybe coming from an email attachment in a phishing mail. Then use the filename of the downloaded lnk file for further investigation through any of the tables we have hightlighted in the query examples provided. \"), mdx(\"h2\", {\n    \"id\": \"how-do-i-protect-myself\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#how-do-i-protect-myself\",\n    \"aria-label\": \"how do i protect myself permalink\",\n    \"className\": \"heading-anchor before\"\n  }, mdx(\"span\", {\n    parentName: \"a\"\n  }, \"#\")), \"How do I protect myself?\"), mdx(\"p\", null, \"One case of protection is to investigate, but that is an \\u201Cafter the fact\\u201D protection,  to stay up front in case of an attack Microsoft has a great way of protecting you if you enable Web Protection in Defender for endpoint. To quote MS: \\u201CWeb threat protection stops access to phishing sites, malware vectors, exploit sites, untrusted or low-reputation sites, as well as sites that you have blocked in your custom indicator list.\\u201D\"), mdx(\"p\", null, \"Read more about Microsofts Web protection in Defender for Enpoint \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/web-threat-protection?view=o365-worldwide\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }, \"here\")), mdx(\"p\", null, \"If you have any suggestions for improvement of this article, please let me know!\"), mdx(\"h3\", {\n    \"id\": \"resources\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#resources\",\n    \"aria-label\": \"resources permalink\",\n    \"className\": \"heading-anchor before\"\n  }, mdx(\"span\", {\n    parentName: \"a\"\n  }, \"#\")), \"Resources\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://learn.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-devicefileevents-table?view=o365-worldwide\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }, \"https://learn.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-devicefileevents-table?view=o365-worldwide\"), mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/web-threat-protection?view=o365-worldwide\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }, \"https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/web-threat-protection?view=o365-worldwide\"), mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://mrd0x.com/phishing-with-chromium-application-mode/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }, \"https://mrd0x.com/phishing-with-chromium-application-mode/\")));\n}\n;\nMDXContent.isMDXComponent = true;","timeToRead":4,"frontmatter":{"author":[{"id":"7efe43a5-8dae-5391-b8c0-1c2acebf8c2e","yamlId":"adriankydlandskaftun","name":"Adrian Kydland Skaftun","initial":"AKS","bio":"Cyber security engineer\n","sns":[["linkedin","https://www.linkedin.com/in/akskaftun/"],["github","https://github.com/bittib010"],["mailto","mailto:adrian.skaftun@amesto.no"]],"avatar":{"normal":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAGQABAQADAQAAAAAAAAAAAAAAAAQBAgMF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAAIB/9oADAMBAAIQAxAAAAGrEnXK6pCZtSs9AH//xAAaEAACAwEBAAAAAAAAAAAAAAABAgAREiED/9oACAEBAAEFAm4FPdkzR1dG57MWfXSwn//EABkRAAEFAAAAAAAAAAAAAAAAAAABAhARIf/aAAgBAwEBPwFqYVP/xAAZEQABBQAAAAAAAAAAAAAAAAAAAQIQESH/2gAIAQIBAT8Bculz/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAECEBEhMXH/2gAIAQEABj8Cro5Szjm78Ebimf/EABoQAQACAwEAAAAAAAAAAAAAAAEAESExUWH/2gAIAQEAAT8hfjKTTuArXcaQCwRCoYuMqB1oRa4AnJg2vWf/2gAMAwEAAgADAAAAEKjo/f/EABgRAQADAQAAAAAAAAAAAAAAAAEAEBEh/9oACAEDAQE/EDO6azWf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EFdFuwsL/8QAHBABAQEBAAIDAAAAAAAAAAAAAREAITFRQYGh/9oACAEBAAE/EJ9YWOMhiJ9OEcV2M0pyIgX4n7vKBFD3NOAznjLQjADw55mGQh3jvvVAwSvXf//Z"},"images":{"fallback":{"src":"/static/cccbb7c63b7ff3e3ed1d721dbf8a3a2f/fc240/adrian.jpg","srcSet":"/static/cccbb7c63b7ff3e3ed1d721dbf8a3a2f/e26e9/adrian.jpg 32w,\n/static/cccbb7c63b7ff3e3ed1d721dbf8a3a2f/d306e/adrian.jpg 64w,\n/static/cccbb7c63b7ff3e3ed1d721dbf8a3a2f/fc240/adrian.jpg 128w,\n/static/cccbb7c63b7ff3e3ed1d721dbf8a3a2f/e270b/adrian.jpg 256w","sizes":"(min-width: 128px) 128px, 100vw"},"sources":[]},"width":128,"height":136}}}}],"title":"Webbrowser based phishing technique","description":"A high overview of the recently discovered phishing technique, and how to hunt for it.","date":"October 1st, 2022","categories":["KQL","Azure Sentinel","Kusto"],"hero":{"medium":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADBUlEQVQoz1XO20/TBwDF8d/7XhaNDsbgL5jRGcxYtj2wSUtHZ6YQsJTOCfv9fm0ptVZGWcCMMrk4SEE2hpJhtyy6m5loBQQtvadUqGgp0NYLXWYKXXTXNyd+F9SXPXxyzts5Qu1UDPFqDL03gTQ+izQaxORJYJiKIfluYRz5Dum8H9mbQHYvoHfHMXjiGP1xDL44eu+GBYyeBQzTcQTJvYgpkEIcm+P1w5+yS26m7nwQoy+F/koM87CTD8ejyL4k9YEkDcEUpmASUyCJyf8snzF4lxGM3gT6qzHUoswedQmKvXspMjQje1OYz16g4cwokjuGOBlFcynC/oszaDa4rj11MYLGFaHaFUHvWUQwh25T7hxDV/oa8+89x0RFAV8VP49u4DSWb39CdkUwBhNouvoYqFTwZZWC/v2lDNWUcVKn5oRGyZBWRe++YjT9IxsPl9FP3WRPaxc9+7bzTdV22g8o0A3/wBHnGST3EnL4F2o6jvNrWQGPSnJAuYUHJbncV+aBahOUbubv4k1UH3Mg6KcXaQjdQRqbZecHDWzTyFT+PIPpUhDL8GlE/20M4RW0HQ7WSvP5450CHilz+ExU09io5aHqBdZVOWRKcqnuGkAw+lPUuSK8KVooPGihUPqIoloztZYmDjvPIfmSGMJpajr7+F35IuvKrTx+ezNSu5G3+lv5V7EFFFvJ7s5B2/05gjF0h/LeUxRVaNklNrFTV09ZxyBitwP5xytInmX04TQVnxwnq8zjsfol1tV5pKteJqnZwUN1PrybT2Z3LuX2XgTrzD3ahvrQHarnlSqRbepKKhxf83H4Lkf8KRpDd7FG7nHiso/vu48y2GxhqMXKSJMJZ5OJUy1WBm2HONvZwheTAYSOmw+w+29xwOHk1VozClsnbxhs2KNZ7PP3aZtbpW1ujWDmT0LpVSaWVphMpLlwI8XojdSTfnlphUB6ldnsXwjHFv6hZ3wam62OwoNWGifmULX28P7Jc7RFs7RF17BH1zg6m3nS2+d/+7/rT3NjtPVahv8AYUVPXQlNBaYAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/6412d10897d06e58fa8c7fa672d6de12/14868/dall-e-hacker.png","srcSet":"/static/6412d10897d06e58fa8c7fa672d6de12/9280c/dall-e-hacker.png 236w,\n/static/6412d10897d06e58fa8c7fa672d6de12/9819a/dall-e-hacker.png 472w,\n/static/6412d10897d06e58fa8c7fa672d6de12/14868/dall-e-hacker.png 944w,\n/static/6412d10897d06e58fa8c7fa672d6de12/313d6/dall-e-hacker.png 1888w","sizes":"(min-width: 944px) 944px, 100vw"},"sources":[]},"width":944,"height":531}}}},"fields":{"slug":"/webbrowser-phishing-lnk-file"},"relatedPosts":[{"id":"e66a3da6-740b-526e-8106-62a9d1ff1f92","timeToRead":1,"fields":{"slug":"/kqlcheat"},"frontmatter":{"title":"Interactive KQL Cheatsheet","date":"February 9th, 2023","categories":["KQL","Cheatsheet","Introductory","Query lessons"],"hero":{"normal":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACoUlEQVQozwXBe0zMAQDA8Z/xp9fMH2xi2jBZXlFUE1bXc5FLD7mrK71EKj2O4li6XOlKO3pMz3WV3iqXHtbQ69jpuvXQlsdscsgj9NiYr89HmB9bBn99qMlzIXy7wI4Nq/C13sRTr9W8OmXB++ZL/KGBL+/kfBhRMve9k4Vv9SzMdbHwWcfnyRxGTTUs/pwgMzYYYW5kKeDKeF8ExceWE7lvDc3HD9DmsJ4LgUmMPStk0ZzJr08apgZiGe2MxTx8i/lvTSz8fsScuZjBoVJGjA9JChIh/HuzHIPOhdqcuxhuJdB2TKA7UUZdQhj+7omknNUwZVAzO6lgZlzJ22eJTHTLeTN8l/72PKZMpXR0l1Cdc4F7qTKE6Vc7uCxxQ+KaRJXqMdnelpxwtKC8pAonGxc8HBTkZmXw430GL1pC0DdIMHacx9Sr5mNPOw/USgJP+DLd34W5V4eQInelIDKcKE85idJior0KObrBlrz0ck6KKrjhnkCZIpyvRjXTJhXPy4J4mS9iolOJue8xFfIk/I4e5Luhj8lGLYLz4b20XE7loiQXkU080b4NRBxpwW7nOfw9MzFV+jCm8UYbdogutRR95DqubVlCVYgj+roKwkRuRPiJmTUO03M7G+HgbivUZ+JJDi0i0q8SsbiA0z4GAryiGK/YzIzGkmmNlK5gR0KtV5But5RsmSNZZ7zprbtD1vU0FGlpzL6eoiFdhbBtowUd2Vpq8k3ESLXs2hNDctwTtKrbPEywQu6wljhne67Y2hPiHoSuUc3zRzcZaE/H2BiLvj6ZHMudNIndyQgUI2y13Ea1spW4kPv4uqlwcgpAebWSQ9YeeDuL0eTlciUthqpL53lSWUT/gI6hwW7amjS0timpjZHRtNKJkv0Swi1s+A/DZtSDRuClQQAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/c06c02a3f8f457b430795fc39bd2ed2f/52ecd/dalle.png","srcSet":"/static/c06c02a3f8f457b430795fc39bd2ed2f/4c508/dalle.png 192w,\n/static/c06c02a3f8f457b430795fc39bd2ed2f/0612f/dalle.png 384w,\n/static/c06c02a3f8f457b430795fc39bd2ed2f/52ecd/dalle.png 768w,\n/static/c06c02a3f8f457b430795fc39bd2ed2f/b54a9/dalle.png 1536w","sizes":"(min-width: 768px) 768px, 100vw"},"sources":[]},"width":768,"height":361}}},"description":"Introducing a new open source tool"}},{"id":"8ec61554-dff6-5a9c-9845-3eb83e41213b","timeToRead":6,"fields":{"slug":"/kusto-detective-agency6"},"frontmatter":{"title":"Kusto Detective - Senior Detective - Big Heist","date":"December 11th, 2022","categories":["KQL","Azure Data Explorer","Data Science"],"hero":{"normal":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,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"},"images":{"fallback":{"src":"/static/d9e052cdd999968c22f9126d306f8d79/c7240/badge.png","srcSet":"/static/d9e052cdd999968c22f9126d306f8d79/de3a1/badge.png 150w,\n/static/d9e052cdd999968c22f9126d306f8d79/30cdc/badge.png 300w,\n/static/d9e052cdd999968c22f9126d306f8d79/c7240/badge.png 600w","sizes":"(min-width: 600px) 600px, 100vw"},"sources":[]},"width":768,"height":768}}},"description":"Walkthrough of Kusto Detective Agency series"}},{"id":"fadcd6fc-3674-5580-9a67-1010e6f5824e","timeToRead":5,"fields":{"slug":"/kusto-detective-agency5"},"frontmatter":{"title":"Kusto Detective - Detective 3 - Ready to play?","date":"December 10th, 2022","categories":["KQL","Azure Data Explorer","Data Science"],"hero":{"normal":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFdUlEQVQ4y1VUaUyUVxS9KFrbxrZRZJHZd9YZdhgZGGQZZtiEcYBhEQSGVTZZ1AFUBAUERMCNoCNVtNWI1ahtTVtjTBMbmtY2baqkaZuuP/rH1PijOjPvNN9oaXqT9/Ly7vnOu++d812KTUghgUhFYmmIF72IVRJ5GP0XawjAi6XX68u7IkmIB8tNElmoF0+goPhNqURypZoUKo03X6ggsSxUq9NnLimDo+qJyI+I1hJRfGpG3m2DqeATIi8tEb1BRL5ypaYmKcW4JJGF6XkCJclVGm+JLJRIERSxkmg1d5CgwFLxx9yF9zA6cRL2vsGn9t6Bx0cnT2DWcRHzF6/g8NgUuvfsf7ynd+Dp2NFTuLTwPqxltj+JSErkTXKlZiW9suZNjuy1dGPB11Mn55GkNz7LzDK7unbthb33AHa0dDB1RIIrMjrR1dTcyey9A+js7kNWrsWtSzY8c5y7guy84u+4yld4r/U8xwptYsad8ek5pBm2POfx5RCKg1hAoJTl5Ze48wpKma2+jRVat6O8soEZsy2ML1QyDhPIlyMtI+/5jONd6PTGTz1vujk1i6Jjk88eGjuFDJPZJZIEQRkUwYJCopCWkYuU1CykpOUgJl4PXbIB6ZlboFCpIZaGMIFIhUyT2TV5Yg6xCZsvLCvGqZhbULY4MHyMq84Vpo6DTBGO4LAYbLe14djJM6ipbYYp2wK5Uo0MoxkFW8sgkYW4RidmUGiterBMlpCY5h0ekUCRMUnN+wYnkJKa7eza1ceKS6tQXdeOM/PXcX/xK3z+5TeYm1+AKbcIu3oO4uDQOCsqqXIeHJlCnDa1Mzo2mbS69FWUmJzprYnaRNFx+pae/WMoLrU5R8am2NTx06iobkZP/zjOvv0ORkYnYatvR1ZuEVradqOpdTczF1U6D41Mewg5PyelGL0913155Xv7Bo9Crgx3mbLNaGjqgDHb4qlw6Ydfsa9/CJXVTSgqqUZ1bStKt9XBL0DsGp04BYu16rNl8/v6C7mRvbtvBIUlNW4eX8428mRsI0+KgEAp5EoNUlJNMBjzEROnhzpCi9KKes46TKnSsEJrlWtweAq+/iLzBj8R0diUgwxZloX+oWlI5WFOTox0YwErLqtFW0cPhg9P4MQpBy5fvQX73mH4bOBzHyMqRseS9JngC5XOw0dmkJNfcuP+F488Ra6uqe941NhiB08gd6cbtrDZc9fA2WhodBo3bt7G1Wu3MDZxHPVNndhaVImtRdsRHaf3kApFKndzux1NrXt+8vz4HGFtY9fDqrqdnM/cNz64w+K1qZAp1IiM1mHu/CXMnjmHoZEJHJmcwYzjEm5+vIj27n5cXrjFtIlp7rrGTuxos//oIbz50SLlbCm53nfgCCSyUKc2MQ0KlYbJFeEsOi4ZBZZtsNU1o66hFdayGnCHhanjWGh4HNukS4dQrHIOjkzDXFT5oUcYkSSYG1ZOlEpbq9PHl+/cyJO5/QPELCQ8nuWZyxlHZqtrgSnHwiSyMObrL2L+GyXudT48p62+/fnA0CRE0pAKsTSEaOnnv6j3wBGK35Tm6O0fB5dsad+DxuZO1Na3ICfX4haKg9wCkcptyja7q2070LijE6077RgeO4ah0WNITDLMf/volxd90y9A7FHm9t0HXG+0Wctr73Z07/2tp+/gk6GRib9PO85h+oQDs2fO4+SMA4OHxp/Z+wafdO3e/3t5ZcM9uUrT8K8HfXyFXiRTqGmDr8DDzjXbl8lXiWgdEanWvhmQay2zPayoavz+rfW8fG6PiNZzGA6rUGk8ZOt8+F4SWRhRbMJmUgVHUVRMEml1hpXLjn8ZvgESIvIOJFohCAiU/S/HYROTM1dGxiSRMjjKw/UP1raHSmSgMDoAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/f1c33454376cde2d699413464544ebbd/c7240/badge.png","srcSet":"/static/f1c33454376cde2d699413464544ebbd/de3a1/badge.png 150w,\n/static/f1c33454376cde2d699413464544ebbd/30cdc/badge.png 300w,\n/static/f1c33454376cde2d699413464544ebbd/c7240/badge.png 600w","sizes":"(min-width: 600px) 600px, 100vw"},"sources":[]},"width":768,"height":768}}},"description":"Walkthrough of Kusto Detective Agency series"}}]}},"pageContext":{"slug":"/webbrowser-phishing-lnk-file","previous":{"title":"TechTalk - Post-pandemic way of work","slug":"/techtalk-post-pandemic-wow"},"next":{"title":"Du er ikke så spesiell som du tror","slug":"/du-er-ikke-saa-spesiell"}}},"staticQueryHashes":["176088207"]}